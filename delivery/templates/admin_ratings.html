<!DOCTYPE html>
<html>
<head>
  <title>Ratings Analytics</title>
</head>
<body>

<!-- ================= HEADER ================= -->
<header class="header">
    <div class="brand">
        <a href="{% url 'home' %}" class="logo-link">
            <img src="{% static 'images/logoo.png' %}" alt="Crave Cart Logo" class="logo">
        </a>
    </div>

    <div class="header-actions">

        <!-- HELP -->
        <a href="{% url 'about' %}" class="icon-btn" title="About Us" aria-label="About Us">
    <span class="icon">â„¹ï¸</span>
    </a>

        <!-- THEME TOGGLE -->
        <button class="icon-btn theme-btn" onclick="toggleTheme()" title="Toggle theme">
            <span id="themeIcon">ğŸŒ™</span>
        </button>

        <!-- PROFILE -->
        <div class="profile-menu">
            <button class="profile-avatar" onclick="toggleProfileMenu(event)">
                <img src="{% static 'images/profile.png' %}" alt="Profile">
            </button>

            <div class="profile-dropdown" id="profileDropdown">
                <div class="profile-header">
                    <img src="{% static 'images/profile.png' %}" class="profile-pic">
                    <div>
                        <strong>{{ username|capfirst }}</strong>
                        <small>Administrator</small>
                    </div>
                </div>

                <div class="dropdown-divider"></div>

                <a href="{% url 'open_add_restaurant' %}" class="dropdown-item">ğŸª Add Restaurant</a>
                <a href="{% url 'open_show_restaurants' %}" class="dropdown-item">ğŸ“‹ Manage Restaurants</a>
                <a href="{% url 'create_coupon' %}" class="dropdown-item">ğŸ·ï¸ Coupons</a>
                <a href="{% url 'admin_orders' %}" class="dropdown-item">ğŸ“¦ Orders</a>

                <div class="dropdown-divider"></div>

                <a href="javascript:void(0)" class="dropdown-item logout"
                   onclick="openLogoutModal()">ğŸšª Log Out</a>
            </div>
        </div>
    </div>
</header>
<h2>ğŸ“Š Restaurant Ratings</h2>

<table border="1" cellpadding="10">
  <tr>
    <th>Item</th>
    <th>Avg Rating</th>
    <th>Total Reviews</th>
  </tr>

  {% for row in data %}
  <tr>
    <td>{{ row.items__item_name }}</td>
    <td>â­ {{ row.avg_rating|floatformat:1 }}</td>
    <td>{{ row.total_reviews }}</td>
  </tr>
  {% endfor %}
</table>


<footer class="footer">
    Â© 2025 CraveCart. All rights reserved. Â· Admin Panel
</footer>

</div>

<!-- ================= LOGOUT MODAL ================= -->
<div class="logout-overlay" id="logoutOverlay">
    <div class="logout-modal">
        <h3>Confirm Logout</h3>
        <p>Are you sure you want to log out?</p>

        <button class="btn primary full-width" onclick="confirmLogout()">
            Yes, Log Me Out
        </button>
    </div>
</div>

<script src="{% static 'js/theme.js' %}"></script>

<script>
function toggleProfileMenu(event) {
    event.stopPropagation();
    document.getElementById("profileDropdown").classList.toggle("show");
}

document.addEventListener("click", () => {
    const dropdown = document.getElementById("profileDropdown");
    if (dropdown) dropdown.classList.remove("show");
});

function openLogoutModal() {
    document.getElementById("logoutOverlay").classList.add("show");
}

function confirmLogout() {
    window.location.href = "{% url 'logout' %}";
}
</script>
</body>
</html>
