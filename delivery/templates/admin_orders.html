{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Incoming Orders | Admin</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- CSS -->
  <link rel="stylesheet" href="{% static 'css/sign_style.css' %}"> 
  <link rel="stylesheet" href="{% static 'css/admin_orders.css' %}">
</head>

<body>
    <!-- ================= HEADER ================= -->
<header class="header">
    <div class="brand">
        <a href="{% url 'home' %}" class="logo-link">
            <img src="{% static 'images/logoo.png' %}" alt="Crave Cart Logo" class="logo">
        </a>
    </div>

    <div class="header-actions">

        <!-- HELP -->
        <button class="icon-btn" title="Help">â“</button>

        <!-- THEME TOGGLE -->
        <button class="icon-btn theme-btn" onclick="toggleTheme()" title="Toggle theme">
            <span id="themeIcon">ğŸŒ™</span>
        </button>

        <!-- PROFILE -->
        <div class="profile-menu">
            <button class="profile-avatar" onclick="toggleProfileMenu(event)">
                <img src="{% static 'images/profile.png' %}" alt="Profile">
            </button>

            <div class="profile-dropdown" id="profileDropdown">
                <div class="profile-header">
                    <img src="{% static 'images/profile.png' %}" class="profile-pic">
                    <div>
                        <strong>{{ username|capfirst }}</strong>
                        <small>Administrator</small>
                    </div>
                </div>

                <div class="dropdown-divider"></div>

                <a href="{% url 'open_add_restaurant' %}" class="dropdown-item">ğŸª Add Restaurant</a>
                <a href="{% url 'open_show_restaurants' %}" class="dropdown-item">ğŸ“‹ Manage Restaurants</a>
                <a href="{% url 'create_coupon' %}" class="dropdown-item">ğŸ·ï¸ Coupons</a>
                <a href="{% url 'admin_orders' %}" class="dropdown-item">ğŸ“¦ Orders</a>

                <div class="dropdown-divider"></div>

                <a href="javascript:void(0)" class="dropdown-item logout"
                   onclick="openLogoutModal()">ğŸšª Log Out</a>
            </div>
        </div>
    </div>
</header>

  <h2>ğŸ“¦ Incoming Orders</h2>

  {% if orders %}
    {% for order in orders %}
      <div class="admin-order-card">

        <!-- TOP -->
        <div class="top">
          <strong>Order #{{ order.order_number }}</strong>
          <span>{{ order.created_at|date:"d M Y, h:i A" }}</span>
        </div>

        <!-- DETAILS -->
        <div class="detail">
          <span class="label">User:</span>
          <span class="value">{{ order.user.username }}</span>
        </div>

        <div class="detail">
          <span class="label">Total:</span>
          <span class="value amount">â‚¹{{ order.total_amount }}</span>
        </div>

        <!-- STATUS -->
        <div class="detail">
          <span class="label">Status:</span>
          <span class="status {{ order.status }}">
            {{ order.get_status_display }}
          </span>
        </div>

        <!-- ACTION -->
        <a class="view-btn" href="{% url 'admin_order_detail' order.id %}">
          View Details â†’
        </a>

      </div>
    {% endfor %}
  {% else %}
    <p class="empty-text">No orders yet ğŸ“­</p>
  {% endif %}

  
<footer class="footer">
    Â© 2025 Crave Cart Â· Admin Panel
</footer>

</div>

<!-- ================= LOGOUT MODAL ================= -->
<div class="logout-overlay" id="logoutOverlay">
    <div class="logout-modal">
        <h3>Confirm Logout</h3>
        <p>Are you sure you want to log out?</p>

        <button class="btn primary full-width" onclick="confirmLogout()">
            Yes, Log Me Out
        </button>
    </div>
</div>

<script src="{% static 'delivery/js/theme.js' %}"></script>

<script>
function toggleProfileMenu(event) {
    event.stopPropagation();
    document.getElementById("profileDropdown").classList.toggle("show");
}

document.addEventListener("click", () => {
    const dropdown = document.getElementById("profileDropdown");
    if (dropdown) dropdown.classList.remove("show");
});

function openLogoutModal() {
    document.getElementById("logoutOverlay").classList.add("show");
}

function confirmLogout() {
    window.location.href = "{% url 'logout' %}";
}
</script>

</body>
</html>
